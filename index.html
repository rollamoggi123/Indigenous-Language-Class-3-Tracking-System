<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—èª 3 èª²ç¨‹æ•¸æ“šå„€è¡¨æ¿ | Indigenous Language Class 3 Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- 
    <!-- Chosen Palette: Warm Neutrals with Teal/Indigo Accents -->
    <!-- Background: Stone-50 (#fafaf9) -->
    <!-- Surface: White (#ffffff) -->
    <!-- Primary Action: Teal-600 -->
    <!-- Secondary/Info: Indigo-600 -->
    <!-- Alert/Status: Amber/Green/Red -->
    -->

    <style>
        /* Chart Container Styling as per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px; /* Mobile base height */
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px; /* Tablet/Desktop height */
            }
        }

        /* Custom Scrollbar for table container */
        .custom-scrollbar::-webkit-scrollbar {
            height: 8px;
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f5f5f4;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d6d3d1;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a29e;
        }
        
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: #fafaf9; /* stone-50 */
            color: #44403c; /* stone-700 */
        }
    </style>

    <!-- Application Structure Plan: 
         1. Dashboard Header: Contextual info (Instructor, Location) & Global Actions.
         2. Analytics Section (The "Wow" Factor): 
            - Summary Cards (Total, Pass, Pending) for immediate status check.
            - Interactive Charts (Donut for Pass Rate, Bar for Item Completion) to visualize gaps.
         3. Detailed Interaction Section:
            - Sortable/Filterable Student Table for individual tracking.
            - Direct manipulation (Click to toggle) triggering Chart updates.
         4. Footer: Notices & Additional Info.
         
         Why this structure?
         It moves from "Macro" (Class Overview) to "Micro" (Individual Student), allowing the instructor
         to first understand the overall situation and then drill down to fix specific student issues.
    -->
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navbar / Header -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-teal-600 text-white p-2 rounded-lg text-xl font-bold">ğŸ“‹</div>
                <div>
                    <h1 class="font-bold text-lg md:text-xl text-stone-800 leading-tight">æ—èª 3 èª²ç¨‹è¿½è¹¤</h1>
                    <p class="text-xs text-stone-500 font-medium">Indigenous Language Class 3</p>
                </div>
            </div>
            <div class="flex items-center gap-4 text-sm">
                <div class="hidden md:flex items-center gap-1 text-stone-600 bg-stone-100 px-3 py-1 rounded-full">
                    <span>ğŸ‘¤</span> <span class="font-bold">Sonay Rolla Moggi</span>
                </div>
                <div class="hidden md:flex items-center gap-1 text-stone-600 bg-stone-100 px-3 py-1 rounded-full">
                    <span>ğŸ“</span> <span class="font-bold">A103</span>
                </div>
                <button onclick="resetData()" class="text-stone-400 hover:text-red-500 transition-colors" title="Reset All Data">
                    ğŸ”„ Reset
                </button>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 space-y-8">

        <!-- Section 1: Introduction & Context -->
        <section class="space-y-4">
            <div class="bg-white rounded-2xl p-6 border border-stone-200 shadow-sm">
                <h2 class="text-2xl font-bold text-stone-800 mb-2">èª²ç¨‹æ¦‚æ³ç¸½è¦½ (Class Overview)</h2>
                <p class="text-stone-600 leading-relaxed mb-4">
                    æœ¬å„€è¡¨æ¿æ—¨åœ¨å”åŠ©æ•™å¸«å³æ™‚æŒæ¡ <strong>å¹¼æ•™ç³»æ—èª 3</strong> èª²ç¨‹çš„å­¸ç”Ÿå­¸ç¿’é€²åº¦ã€‚
                    é€éä¸‹æ–¹çš„æ•¸æ“šè¦–è¦ºåŒ–ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿè­˜åˆ¥ç­ç´šæ•´é«”çš„é€šéç‡ï¼Œä»¥åŠå„é …è©•é‡ï¼ˆå¹³æ™‚ã€æœŸä¸­ã€æœŸæœ«ã€å£èªªï¼‰çš„ç¹³äº¤ç‹€æ³ã€‚
                    é»æ“Šä¸‹æ–¹åˆ—è¡¨ä¸­çš„é …ç›®å¯å³æ™‚æ›´æ–°ç‹€æ…‹èˆ‡åœ–è¡¨ã€‚
                </p>
                
                <!-- Key Metrics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                    <div class="bg-stone-50 rounded-xl p-4 border-l-4 border-blue-500 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-bold text-stone-500 uppercase tracking-wider">Total Students</p>
                            <p class="text-3xl font-extrabold text-stone-800" id="stat-total">0</p>
                        </div>
                        <div class="text-3xl">ğŸ‘¥</div>
                    </div>
                    <div class="bg-stone-50 rounded-xl p-4 border-l-4 border-green-500 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-bold text-stone-500 uppercase tracking-wider">Passed</p>
                            <p class="text-3xl font-extrabold text-green-700" id="stat-passed">0</p>
                        </div>
                        <div class="text-3xl">âœ…</div>
                    </div>
                    <div class="bg-stone-50 rounded-xl p-4 border-l-4 border-amber-500 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-bold text-stone-500 uppercase tracking-wider">Pending</p>
                            <p class="text-3xl font-extrabold text-amber-700" id="stat-pending">0</p>
                        </div>
                        <div class="text-3xl">â³</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Analytics Visualization -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Chart 1: Pass Status Distribution -->
            <div class="bg-white rounded-2xl p-6 border border-stone-200 shadow-sm flex flex-col">
                <div class="mb-4">
                    <h3 class="text-lg font-bold text-stone-800">åŠæ ¼æ¯”ä¾‹åˆ†æ (Pass Rate)</h3>
                    <p class="text-sm text-stone-500">å·²é€šé vs å¾…å®Œæˆå­¸ç”Ÿçš„æ¯”ä¾‹åˆ†ä½ˆ</p>
                </div>
                <div class="flex-grow flex items-center justify-center bg-stone-50 rounded-xl p-4">
                    <div class="chart-container">
                        <canvas id="passRateChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Chart 2: Item Completion Breakdown -->
            <div class="bg-white rounded-2xl p-6 border border-stone-200 shadow-sm flex flex-col">
                <div class="mb-4">
                    <h3 class="text-lg font-bold text-stone-800">å„é …ä½œæ¥­å®Œæˆåº¦ (Completion Breakdown)</h3>
                    <p class="text-sm text-stone-500">åˆ†æå“ªé …ä½œæ¥­æ˜¯å­¸ç”Ÿé€šéçš„ä¸»è¦ç“¶é ¸</p>
                </div>
                <div class="flex-grow flex items-center justify-center bg-stone-50 rounded-xl p-4">
                    <div class="chart-container">
                        <canvas id="completionChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Interactive Student List -->
        <section>
            <div class="bg-white rounded-2xl border border-stone-200 shadow-lg overflow-hidden">
                <div class="p-6 border-b border-stone-200 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-stone-50">
                    <div>
                        <h3 class="text-lg font-bold text-stone-800">å­¸ç”Ÿè©³ç´°åå–® (Student Details)</h3>
                        <p class="text-sm text-stone-500">é»æ“Šåœ–ç¤ºå¯åˆ‡æ›ç‹€æ…‹ï¼Œè³‡æ–™å°‡è‡ªå‹•å„²å­˜</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-sm font-bold text-stone-600">Filter:</span>
                        <select id="statusFilter" onchange="renderTable()" class="bg-white border border-stone-300 text-stone-700 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block p-2">
                            <option value="all">é¡¯ç¤ºå…¨éƒ¨ (All)</option>
                            <option value="passed">å·²é€šé (Passed)</option>
                            <option value="pending">å¾…è™•ç† (Pending)</option>
                        </select>
                    </div>
                </div>
                
                <div class="overflow-x-auto custom-scrollbar">
                    <table class="w-full text-left border-collapse min-w-[800px]">
                        <thead class="bg-stone-100 text-stone-600 uppercase text-xs font-bold tracking-wider">
                            <tr>
                                <th class="p-4 w-12 text-center">#</th>
                                <th class="p-4">å§“å / Name</th>
                                <th class="p-4 text-center">å¹³æ™‚<br>Regular</th>
                                <th class="p-4 text-center">æœŸä¸­<br>Midterm</th>
                                <th class="p-4 text-center bg-teal-50 text-teal-800">æœŸæœ« I<br>Final 1</th>
                                <th class="p-4 text-center bg-teal-50 text-teal-800">æœŸæœ« II<br>Final 2</th>
                                <th class="p-4 text-center bg-indigo-50 text-indigo-800">å£èªª<br>Oral</th>
                                <th class="p-4 text-center text-amber-600">éœ€ä¿®æ­£<br>Revise</th>
                                <th class="p-4 text-center">ç‹€æ…‹<br>Status</th>
                                <th class="p-4">å‚™è¨»<br>Note</th>
                            </tr>
                        </thead>
                        <tbody id="studentTableBody" class="divide-y divide-stone-100 text-sm md:text-base">
                            <!-- Rows will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Notices -->
        <section class="bg-amber-50 border-l-4 border-amber-400 p-6 rounded-r-xl shadow-sm">
            <h4 class="text-amber-900 font-bold flex items-center gap-2 text-lg">
                âš ï¸ è£œè€ƒèˆ‡è£œäº¤èªªæ˜ (Notice)
            </h4>
            <div class="mt-2 text-amber-800">
                <p class="mb-2">å…è¨±å­¸ç”Ÿè£œäº¤å ±å‘ŠåŠå£èªªæ¸¬é©—(è£œè€ƒ)ä¸¦ä¸Šå‚³éŒ„éŸ³æª”ã€‚è«‹æé†’å­¸ç”Ÿæ³¨æ„ä»¥ä¸‹æ™‚ç¨‹ï¼š</p>
                <div class="flex flex-wrap gap-4 font-mono font-bold mt-2">
                    <span class="bg-amber-100 px-3 py-1 rounded">ğŸ“… 01/09 (Final Exam)</span>
                    <span class="bg-amber-100 px-3 py-1 rounded">â° 14:10 Start</span>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-stone-800 text-stone-400 py-8 text-center text-sm mt-8">
        <p>æ—èª 3 èª²ç¨‹ç®¡ç†ç³»çµ± | Indigenous Language Class Tracker</p>
        <p class="mt-2 text-xs text-stone-500">Generated for Educational Use</p>
    </footer>

    <!-- LOGIC START -->
    <script>
        // --- Data Storage: Base data in JS Array ---
        // Using the 17 students provided in the source report
        const initialData = [
            { id: 1, name: "å²ç¿", studentId: "11106210", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 2, name: "ç‹å¦¤å›", studentId: "11206201", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 3, name: "å»–äºå¯°", studentId: "11206202", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 4, name: "èƒ¡å¼˜æ˜“", studentId: "11206203", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 5, name: "å‘‚é Œæ©", studentId: "11206210", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 6, name: "æ¥Šèˆ’é–‘", studentId: "11206212", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 7, name: "è‘£éŸ‹èª ", studentId: "11206214", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 8, name: "è˜‡é‚±ç«‹å®", studentId: "11206215", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 9, name: "æ—å­å«ˆ", studentId: "11206217", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 10, name: "æ—èŠ³å®‡", studentId: "11206221", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 11, name: "æ—è©©æ™¨", studentId: "11206222", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 12, name: "é­ç¿”æ…§", studentId: "11206224", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 13, name: "é»ƒæ¹˜èŒ¹", studentId: "11206225", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 14, name: "ä½™æ™¨å„€", studentId: "11206226", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 15, name: "è‘›é›¯", studentId: "11206227", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 16, name: "æ—å­å«£", studentId: "11206230", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" },
            { id: 17, name: "Malinda", studentId: "", regular: false, midterm: false, final0102: false, final0109: false, oral: false, needsRevision: false, note: "" }
        ];

        // --- State Management ---
        let students = JSON.parse(localStorage.getItem('class3_data')) || initialData;
        let passRateChart = null;
        let completionChart = null;

        // --- Core Logic: Check Pass Condition ---
        function checkPass(s) {
            const finals = s.final0102 || s.final0109;
            const required = s.regular && s.midterm && s.oral && finals;
            return required;
        }

        // --- Interaction: Toggle Status ---
        function toggleStatus(id, field) {
            const student = students.find(s => s.id === id);
            if (student) {
                student[field] = !student[field];
                saveData();
                updateUI();
            }
        }

        // --- Interaction: Update Note ---
        function updateNote(id, value) {
            const student = students.find(s => s.id === id);
            if (student) {
                student.note = value;
                saveData();
            }
        }

        // --- Data Persistence ---
        function saveData() {
            localStorage.setItem('class3_data', JSON.stringify(students));
        }

        function resetData() {
            if(confirm("é‡ç½®æ‰€æœ‰è³‡æ–™å›åˆ°é è¨­å€¼? (Reset to default?)")) {
                students = JSON.parse(JSON.stringify(initialData)); // Deep copy
                saveData();
                updateUI();
            }
        }

        // --- Rendering: Charts ---
        function initCharts() {
            // 1. Pass Rate Chart (Donut)
            const ctx1 = document.getElementById('passRateChart').getContext('2d');
            passRateChart = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['Passed (é€šé)', 'Pending (å¾…è™•ç†)'],
                    datasets: [{
                        data: [0, 0],
                        backgroundColor: ['#10b981', '#f59e0b'], // Teal/Green & Amber
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });

            // 2. Completion Breakdown Chart (Bar)
            const ctx2 = document.getElementById('completionChart').getContext('2d');
            completionChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['å¹³æ™‚ (Reg)', 'æœŸä¸­ (Mid)', 'æœŸæœ« I/II', 'å£èªª (Oral)'],
                    datasets: [{
                        label: 'å·²å®Œæˆäººæ•¸ (Completed Count)',
                        data: [0, 0, 0, 0],
                        backgroundColor: '#6366f1', // Indigo
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: students.length, ticks: { stepSize: 1 } }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function updateCharts() {
            const passedCount = students.filter(checkPass).length;
            const pendingCount = students.length - passedCount;

            // Update Donut
            passRateChart.data.datasets[0].data = [passedCount, pendingCount];
            passRateChart.update();

            // Update Bar
            const regCount = students.filter(s => s.regular).length;
            const midCount = students.filter(s => s.midterm).length;
            const finalCount = students.filter(s => s.final0102 || s.final0109).length;
            const oralCount = students.filter(s => s.oral).length;

            completionChart.data.datasets[0].data = [regCount, midCount, finalCount, oralCount];
            completionChart.update();
        }

        // --- Rendering: Table & Stats ---
        function renderTable() {
            const tbody = document.getElementById('studentTableBody');
            const filter = document.getElementById('statusFilter').value;
            tbody.innerHTML = '';

            let totalDisplayed = 0;
            let totalPassed = 0;

            students.forEach((s, index) => {
                const isPassed = checkPass(s);
                if (isPassed) totalPassed++;
                
                // Filter Logic
                if (filter === 'passed' && !isPassed) return;
                if (filter === 'pending' && isPassed) return;

                totalDisplayed++;

                const tr = document.createElement('tr');
                tr.className = `hover:bg-stone-50 transition-colors border-b border-stone-100 ${isPassed ? 'bg-green-50/30' : ''}`;
                
                // Helper for checkbox button
                const createCheckBtn = (field, activeColorClass) => `
                    <button onclick="toggleStatus(${s.id}, '${field}')" 
                        class="w-8 h-8 rounded-full flex items-center justify-center transition-all ${s[field] ? activeColorClass : 'bg-stone-100 text-stone-300 hover:bg-stone-200'}">
                        ${s[field] ? 'â—' : 'â—‹'}
                    </button>
                `;
                
                // Note: Using Unicode circles instead of SVG for "NO SVG" compliance, but styling them like buttons.
                // Or better, use simple text logic but styled nicely.
                // Actually, let's use Unicode Checkmark inside the button.
                
                const btnStyle = (active, colorClass) => 
                    `class="w-8 h-8 rounded-full inline-flex items-center justify-center text-lg transition-all ${active ? colorClass : 'bg-stone-200 text-stone-400 hover:bg-stone-300'}"`;

                tr.innerHTML = `
                    <td class="p-4 text-center text-stone-400">${index + 1}</td>
                    <td class="p-4">
                        <div class="font-bold text-stone-800">${s.name}</div>
                        <div class="text-xs text-stone-400 font-mono">${s.studentId}</div>
                    </td>
                    <td class="p-4 text-center"><button onclick="toggleStatus(${s.id}, 'regular')" ${btnStyle(s.regular, 'bg-green-100 text-green-600 shadow-sm')}>${s.regular ? 'âœ”' : ''}</button></td>
                    <td class="p-4 text-center"><button onclick="toggleStatus(${s.id}, 'midterm')" ${btnStyle(s.midterm, 'bg-green-100 text-green-600 shadow-sm')}>${s.midterm ? 'âœ”' : ''}</button></td>
                    <td class="p-4 text-center"><button onclick="toggleStatus(${s.id}, 'final0102')" ${btnStyle(s.final0102, 'bg-teal-100 text-teal-600 shadow-sm')}>${s.final0102 ? 'âœ”' : ''}</button></td>
                    <td class="p-4 text-center"><button onclick="toggleStatus(${s.id}, 'final0109')" ${btnStyle(s.final0109, 'bg-teal-100 text-teal-600 shadow-sm')}>${s.final0109 ? 'âœ”' : ''}</button></td>
                    <td class="p-4 text-center"><button onclick="toggleStatus(${s.id}, 'oral')" ${btnStyle(s.oral, 'bg-indigo-100 text-indigo-600 shadow-sm')}>${s.oral ? 'âœ”' : ''}</button></td>
                    <td class="p-4 text-center"><button onclick="toggleStatus(${s.id}, 'needsRevision')" ${btnStyle(s.needsRevision, 'bg-amber-100 text-amber-600 shadow-sm')}>${s.needsRevision ? '!' : ''}</button></td>
                    <td class="p-4 text-center">
                        <span class="px-3 py-1 rounded-full text-xs font-bold border ${isPassed ? 'bg-green-100 text-green-700 border-green-200' : 'bg-stone-100 text-stone-500 border-stone-200'}">
                            ${isPassed ? 'PASS' : 'PENDING'}
                        </span>
                    </td>
                    <td class="p-4">
                        <input type="text" value="${s.note}" onblur="updateNote(${s.id}, this.value)" 
                            class="bg-transparent border-b border-stone-200 focus:border-teal-500 focus:outline-none w-full text-sm text-stone-600 placeholder-stone-300" placeholder="...">
                    </td>
                `;
                tbody.appendChild(tr);
            });

            // Update Summary Cards
            document.getElementById('stat-total').textContent = students.length;
            document.getElementById('stat-passed').textContent = totalPassed;
            document.getElementById('stat-pending').textContent = students.length - totalPassed;
        }

        function updateUI() {
            renderTable();
            updateCharts();
        }

        // --- Initialization ---
        window.addEventListener('DOMContentLoaded', () => {
            initCharts();
            updateUI();
        });

    </script>
    <!-- Visualization & Content Choices:
         1. Goal: Overview -> Viz: Summary Cards (Total/Pass/Fail) -> Justification: Immediate status awareness.
         2. Goal: Analysis -> Viz: Donut Chart (Pass Rate) & Bar Chart (Completion) -> Justification: Visualizing the bottleneck (e.g., is everyone missing Oral?).
         3. Goal: Management -> Viz: Interactive Table -> Justification: Direct manipulation of student data.
         4. Interaction: Click-to-toggle -> Updates Charts -> Justification: Immediate feedback loop for "What-if" scenarios.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. All icons are Unicode or CSS-styled HTML elements. -->
</body>
</html>
